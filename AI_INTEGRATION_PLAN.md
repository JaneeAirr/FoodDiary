# План интеграции ИИ и расширения функционала

## Этап 1: Google OAuth (Приоритет: Высокий)

### Backend
1. Установить `django-allauth` или `social-auth-app-django`
2. Настроить Google OAuth в settings.py
3. Создать endpoint `/api/auth/google/`
4. Обновить User модель для поддержки OAuth

### Frontend
1. Добавить кнопку "Continue with Google" на страницах Login/Register
2. Обработать callback от Google
3. Сохранить токены

---

## Этап 2: Расширение моделей пользователя

### Новые поля в User:
- `gender` (M/F/Other)
- `goal` (weight_loss/weight_gain/maintenance)
- `allergies` (JSONField)
- `dietary_restrictions` (JSONField)
- `display_name`
- `show_display_name`
- `dietary_preference` (none/vegetarian/vegan/gluten_free/keto/paleo)
- `theme_preference` (light/dark/system)

### Новая модель: PsychFoodProfile
- `user` (OneToOne)
- `evening_overeating` (Boolean)
- `sweet_stress` (Boolean)
- `irregular_eating` (Boolean)
- `ai_analysis` (TextField) - результат анализа ИИ

---

## Этап 3: ИИ интеграция

### Варианты ИИ API:
1. **OpenAI GPT-4** (рекомендуется)
   - Анализ пищевого поведения
   - Генерация рекомендаций
   - Распознавание текста из фото

2. **Google Gemini**
   - Vision API для фото
   - Анализ текста

3. **Claude (Anthropic)**
   - Анализ и рекомендации

### Структура ИИ сервиса:
```
backend/
  ai/
    __init__.py
    services.py      # ИИ сервисы
    prompts.py       # Промпты для ИИ
    models.py        # Модели для ИИ данных
    views.py         # API endpoints
```

### Endpoints:
- `POST /api/ai/analyze-behavior/` - Анализ поведения
- `POST /api/ai/recommendations/` - Получить рекомендации
- `POST /api/ai/parse-meal-text/` - Распознать еду из текста
- `POST /api/ai/parse-meal-image/` - Распознать еду из фото
- `POST /api/ai/generate-meal-plan/` - Генерация плана питания

---

## Этап 4: Реализация функций

### 4.1 Поведенческий анализ
- Анализ времени приемов пищи
- Обнаружение паттернов (переедание вечером, пропуски завтраков)
- Расчет индексов (дисциплина, баланс БЖУ)

### 4.2 ИИ-рекомендации
- Персональные советы на основе данных
- Предупреждения о дефицитах
- Рекомендации продуктов

### 4.3 Умный план питания
- Генерация меню с учетом:
  - Калорий
  - Бюджета
  - Времени готовки
  - Предпочтений

### 4.4 Распознавание еды
- Текст: "съел плов и чай" → парсинг в продукты
- Фото: загрузка изображения → распознавание блюда

---

## Этап 5: Расширенная аналитика

### Новые индексы:
1. Индекс пищевой дисциплины
2. Индекс баланса БЖУ
3. Индекс устойчивости привычек

### Новые графики:
- Вес vs калории
- Регулярность питания
- Тренды по макронутриентам

---

## Этап 6: Уведомления

- Напоминания о приемах пищи
- Предупреждения о срывах
- Умные уведомления ("Сегодня вы не ели овощи")

---

## Этап 7: Экспорт и отчеты

- PDF отчет за месяц
- Экспорт для врача/тренера
- История изменений

---

## Порядок реализации

1. ✅ Обновить дизайн (темная тема, сайдбар)
2. ⏳ Добавить Google OAuth
3. ⏳ Расширить модели пользователя
4. ⏳ Настроить ИИ сервис (OpenAI)
5. ⏳ Реализовать поведенческий анализ
6. ⏳ Добавить ИИ-рекомендации
7. ⏳ Реализовать распознавание еды
8. ⏳ Добавить умный план питания
9. ⏳ Расширить аналитику
10. ⏳ Добавить уведомления
11. ⏳ Реализовать экспорт

